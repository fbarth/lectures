library(twitteR)
install.packages('twitteR')
library(twitteR)
cred <- OAuthFactory$new(consumerKey="2q2Kc0bmJbdfisfFuLtTrw",
consumerSecret="mSAwiCMCqy503soUYIOWUKTM3jloMVFFIC035n8gk8",
requestURL="https://api.twitter.com/oauth/request_token",
accessURL="https://api.twitter.com/oauth/access_token",
authURL="http://api.twitter.com/oauth/authorize")
cred$handshake()
registerTwitterOAuth(cred)
about_eleicoes <- searchTwitter('eleicoes', n=250)
df <- twListToDF(about_eleicoes)
save(df, file="../data/20140424_eleicoes.rda")
setwd("~/Documents/palestras/coanalytics2014/scripts")
save(df, file="../data/20140424_eleicoes.rda")
Sys.setenv(NOAWT=TRUE)
library(tm)
library(Snowball)
Sys.setenv(NOAWT=TRUE)
library(RXKCD)
install.packages('RXKCD')
library(tm)
library(SnowballC)
install.packages('SnowballC')
library(SnowballC)
library(wordcloud)
library(RColorBrewer)
load("../data/20140424_eleicoes.rda")
myCorpus <- Corpus(VectorSource(df$text))
inspect(myCorpus[1:3])
myCorpus <- tm_map(myCorpus, function(x) iconv(x,to="ASCII//TRANSLIT"))
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, removeWords, stopwords('portuguese'))
myCorpus <- tm_map(myCorpus, removeWords, c('mim', 'alguem', 'nao', 'pra'))
inspect(myCorpus[1:3])
myTable <- TermDocumentMatrix(myCorpus)
myTable
inspect(myTable[1:10,1:10])
findFreqTerms(myTable, lowfreq=20)
findAssocs(myTable, 'eleicoes', 0.1)
myCorpus <- tm_map(myCorpus, stemDocument, language="portuguese")
inspect(myCorpus[1:3])
docs_term <- DocumentTermMatrix(myCorpus)
set.seed(1234)
elbow <- function(dataset) {
wss <- numeric(15)
for (i in 1:15) wss[i] <- sum(kmeans(dataset, centers = i, nstart = 100)$withinss)
plot(1:15, wss, type = "b", main = "Elbow method", xlab = "Number of Clusters",
ylab = "Within groups sum of squares", pch = 8)
}
system.time(elbow(docs_term))
cluster_model <- kmeans(docs_term, centers= 9, nstart= 100)
table(cluster_model$cluster)
cluster_model$withinss
df[cluster_model$cluster == 1, c(1,10)]
df[cluster_model$cluster == 5, c(1,10)]
df[cluster_model$cluster == 9, c(1,10)]
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 1, c('text')])))
my_wordcloud <- function(myCorpus){
myCorpus <- tm_map(myCorpus, function(x) iconv(x, to = "ASCII//TRANSLIT"))
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, removeWords, stopwords("portuguese"))
myTable <- TermDocumentMatrix(myCorpus)
m <- as.matrix(myTable)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
pal <- brewer.pal(8, "Dark2")
pal <- pal[-(1:2)]
wordcloud(d$word,d$freq, scale=c(6,1), min.freq=10,max.words=100, random.order=FALSE, colors=pal)
}
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 1, c('text')])))
my_wordcloud <- function(myCorpus){
myCorpus <- tm_map(myCorpus, function(x) iconv(x, to = "ASCII//TRANSLIT"))
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, removeWords, stopwords("portuguese"))
myTable <- TermDocumentMatrix(myCorpus)
m <- as.matrix(myTable)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
pal <- brewer.pal(8, "Dark2")
pal <- pal[-(1:2)]
wordcloud(d$word,d$freq, scale=c(6,1), min.freq=1,max.words=100, random.order=FALSE, colors=pal)
}
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 1, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 2, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 3, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 4, c('text')])))
about_eleicoes <- searchTwitter('economist brasil', n=250)
df <- twListToDF(about_eleicoes)
save(df, file="../data/20140424_economist_brasil.rda")
load("../data/20140424_economist_brasil.rda")
myCorpus <- Corpus(VectorSource(df$text))
inspect(myCorpus[1:3])
myCorpus <- tm_map(myCorpus, function(x) iconv(x,to="ASCII//TRANSLIT"))
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, removeWords, stopwords('portuguese'))
myCorpus <- tm_map(myCorpus, removeWords, c('mim', 'alguem', 'nao', 'pra'))
inspect(myCorpus[1:3])
myTable <- TermDocumentMatrix(myCorpus)
myTable
inspect(myTable[1:10,1:10])
findFreqTerms(myTable, lowfreq=20)
findAssocs(myTable, 'improdutivo', 0.1)
findAssocs(myTable, 'improdutivo', 0.8)
myCorpus <- tm_map(myCorpus, stemDocument, language="portuguese")
inspect(myCorpus[1:3])
docs_term <- DocumentTermMatrix(myCorpus)
system.time(elbow(docs_term))
cluster_model <- kmeans(docs_term, centers= 4, nstart= 100)
table(cluster_model$cluster)
cluster_model$withinss
df[cluster_model$cluster == 2, c(1,10)]
df[cluster_model$cluster == 1, c(1,10)]
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 1, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 2, c('text')])))
my_wordcloud <- function(myCorpus){
myCorpus <- tm_map(myCorpus, function(x) iconv(x, to = "ASCII//TRANSLIT"))
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, removeWords, stopwords("portuguese"))
myTable <- TermDocumentMatrix(myCorpus)
m <- as.matrix(myTable)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
pal <- brewer.pal(8, "Dark2")
pal <- pal[-(1:2)]
wordcloud(d$word,d$freq, scale=c(6,1), min.freq=5,max.words=100, random.order=FALSE, colors=pal)
}
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 1, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 2, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 3, c('text')])))
my_wordcloud(Corpus(VectorSource(df[cluster_model$cluster == 4, c('text')])))
